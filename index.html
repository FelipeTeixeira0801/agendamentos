<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=0.94, viewport-fit=cover" />
<title>AgendApp — Cliente</title>
<link rel="icon" href="/agendamentos/agendapp.png?v=133" />
<style>
  :root{
    --bg:#0b0b0e; --surface:#131318; --surface-2:#1a1a21;
    --border:#26262e; --text:#f5f5f7; --muted:#a8a8b3; --accent:#2dd4bf;
    --ok:#22c55e; --danger:#f87171;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{font-family:system-ui, Arial, sans-serif;margin:0;background:var(--bg);color:var(--text);font-size:17px}
  a{color:var(--text);text-decoration:none}

  header{position:sticky;top:0;z-index:10;background:var(--surface);
    border-bottom:1px solid var(--border);padding:10px 14px;display:flex;justify-content:space-between;align-items:center}
  .brand{display:flex;align-items:center;gap:12px}
  .brand img{width:64px;height:64px;object-fit:cover;border-radius:12px;filter:drop-shadow(0 0 10px rgba(45,212,191,.35))}
  .brand .name{font-weight:900;letter-spacing:.35px;font-size:26px;line-height:1}
  @media (max-width:380px){ .brand img{width:58px;height:58px} .brand .name{font-size:24px} }
  header .adm{border:1px solid var(--border);padding:8px 12px;border-radius:10px;background:transparent}
  header .adm:hover{border-color:var(--accent)}

  .container{max-width:960px;margin:12px auto 28px;padding:0 12px}
  .stack{display:grid;gap:16px}
  .card{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:14px}
  .card h3{margin:0 0 8px}
  .sub{color:var(--muted);font-size:14px;margin:2px 0 10px}

  /* Data (semana) */
  .weekHeader{display:grid;grid-template-columns:40px 1fr auto;gap:10px;align-items:center;margin-bottom:8px;}
  .monthLabel{text-align:center;font-weight:800;text-transform:capitalize;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:18px}
  .weekNav{display:flex;gap:8px}
  .iconBtn{display:inline-flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:12px;border:1px solid var(--border);background:var(--surface-2);color:var(--text);cursor:pointer;font-size:18px}
  .iconBtn:hover{border-color:var(--accent)}
  .weekStrip{display:flex;gap:10px;overflow-x:auto;padding:6px 2px 8px;-webkit-overflow-scrolling:touch;scroll-snap-type:x proximity;min-height:82px;}
  .dayBtn{min-width:70px;scroll-snap-align:center;border:1px solid var(--border);border-radius:14px;background:var(--surface-2);color:var(--text);padding:12px 10px;display:grid;justify-items:center;gap:4px;cursor:pointer}
  .dayBtn .dow{font-size:12px;color:var(--muted)}
  .dayBtn .num{font-weight:800;font-size:18px}
  .dayBtn.active{border-color:var(--accent);box-shadow:0 0 0 2px rgba(45,212,191,.25) inset}

  /* Serviços */
  .servicesGrid{display:grid;gap:10px}
  @media (min-width:480px){ .servicesGrid{grid-template-columns:1fr 1fr} }
  @media (min-width:840px){ .servicesGrid{grid-template-columns:1fr 1fr 1fr 1fr} }
  .svcItem{border:1px solid var(--border);border-radius:12px;background:var(--surface-2);display:flex;align-items:center;gap:10px;padding:10px 12px;}
  .svcItem > input{accent-color:var(--accent);transform:scale(1.1)}
  .svcLabel{flex:1;min-width:0}
  .svcPrice{font-weight:700;white-space:nowrap}
  .priceRow{margin-top:8px;display:flex;justify-content:space-between;align-items:center;}
  .total{font-weight:800;font-size:19px}

  /* Horários */
  .timeSelect{margin-top:2px}
  #timeToggle{width:100%;display:flex;justify-content:space-between;align-items:center;padding:16px;border-radius:14px;border:2px solid var(--border);background:var(--surface-2);color:var(--text);cursor:pointer;font-size:17px}
  #timeToggle:hover{border-color:var(--accent)}
  .timeBox{display:none;margin-top:10px}
  .timeSelect.open .timeBox{display:block}
  .timeGrid{display:grid;gap:12px;grid-template-columns:repeat(3,1fr)}
  @media (min-width:540px){.timeGrid{grid-template-columns:repeat(4,1fr)}}
  @media (min-width:900px){.timeGrid{grid-template-columns:repeat(6,1fr)}}
  button{padding:12px 16px;border-radius:12px;border:1px solid var(--border);background:var(--surface-2);color:var(--text);cursor:pointer;font-size:17px}
  button.ghost{background:transparent}
  button:hover{border-color:var(--accent)}
  .timeBtn{width:100%;font-weight:700;min-height:50px}

  /* Modal */
  dialog{border:none;border-radius:16px;max-width:520px;width:92%;background:var(--surface);color:var(--text);padding:0}
  dialog::backdrop{background:rgba(0,0,0,.55);backdrop-filter:blur(2px)}
  .sheet{padding:18px}
  .sheet h3{margin:0 0 10px;font-size:18px}
  .summary{display:grid;gap:8px;margin-bottom:12px}
  .sumRow{display:flex;justify-content:space-between;gap:12px;align-items:center}
  .muted{color:var(--muted);font-size:14px}
  .chips{display:flex;flex-wrap:wrap;gap:6px}
  .chip{padding:6px 8px;border-radius:999px;background:var(--surface-2);border:1px solid var(--border);font-size:14px}
  .sheet-form{display:grid;gap:12px}
  .field{display:grid;gap:6px}
  .field span{font-size:14px;color:var(--muted)}
  .field input{padding:14px 12px;border-radius:12px;border:1px solid var(--border);background:#0f0f14;color:var(--text);font-size:17px}
  .field input:focus{outline:none;border-color:var(--accent)}
  .sheet-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:4px}
  .primary{border-color:var(--accent);box-shadow:inset 0 0 0 1px rgba(45,212,191,.35)}
  .feedback{margin-top:10px;font-size:14px}
  .feedback.ok{color:var(--ok)}
  .feedback.erro{color:var(--danger)}
</style>
</head>
<body>
  <header>
    <div class="brand">
      <img src="/agendamentos/agendapp.png?v=133" alt="Logo AgendApp" />
      <span class="name">AgendApp</span>
    </div>
    <a class="adm" href="./admin.html">Área do ADM</a>
  </header>

  <main class="container">
    <div class="stack">

      <!-- BLOCO 1: DATA -->
      <section class="card" aria-labelledby="sec-data">
        <h3 id="sec-data">Escolha a data</h3>
        <p class="sub">Atendimento de <b>terça a sábado</b>, 08:00–19:00.</p>

        <div class="weekHeader">
          <button id="prevWeek" class="iconBtn" title="Semana anterior">‹</button>
          <div id="monthLabel" class="monthLabel">—</div>
          <div class="weekNav">
            <button id="btnHoje" class="iconBtn" title="Semana atual">●</button>
            <button id="nextWeek" class="iconBtn" title="Próxima semana">›</button>
          </div>
        </div>

        <div id="weekGrid" class="weekStrip"></div>
      </section>

      <!-- BLOCO 2: SERVIÇOS -->
      <section class="card" aria-labelledby="sec-servicos">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h3 id="sec-servicos" style="margin:0">Escolha os serviços</h3>
          <button class="ghost" id="btnTabela" type="button">Ver tabela de preços</button>
        </div>

        <div class="servicesGrid" id="services"></div>
        <div class="priceRow">
          <span class="sub">Selecione pelo menos 1 serviço</span>
          <span class="total" id="total">Total: R$ 0,00</span>
        </div>
      </section>

      <!-- BLOCO 3: HORÁRIOS -->
      <section class="card" aria-labelledby="sec-horarios">
        <h3 id="sec-horarios">Escolha o horário</h3>

        <!-- >>> contêiner esperado pelo client.js (volta dele!) <<< -->
        <div id="timeSelect" class="timeSelect">
          <button id="timeToggle" class="dateInput" type="button" aria-expanded="false" aria-controls="timeBox">
            <span id="timeLabel" style="font-weight:700">Selecionar horário</span>
            <span style="font-size:13px;color:var(--muted)">toque para ver</span>
          </button>

          <div id="timeBox" class="timeBox">
            <div id="timeGrid" class="timeGrid"></div>
            <p class="sub" id="info" style="margin-top:8px">Escolha um dia para ver os horários.</p>
          </div>
        </div>

        <!-- input escondido para lógica -->
        <input type="date" id="data" style="display:none" />
      </section>

    </div>
  </main>

  <!-- Modal confirmação -->
  <dialog id="dlg">
    <div class="sheet">
      <h3 id="dlgTitulo">Confirmar</h3>
      <div id="resumo" class="summary"></div>

      <form id="formAgendar" class="sheet-form">
        <label class="field">
          <span>Nome</span>
          <input type="text" name="nome" autocomplete="name" required />
        </label>
        <label class="field">
          <span>Telefone (WhatsApp)</span>
          <input type="tel" name="telefone" inputmode="tel" placeholder="(00) 00000-0000" required />
        </label>
        <div class="sheet-actions">
          <button type="button" class="ghost" id="btnCancelar">Voltar</button>
          <button type="submit" class="primary">Confirmar</button>
        </div>
      </form>

      <p id="msg" class="feedback"></p>
    </div>
  </dialog>

  <!-- Modal Tabela de preços -->
  <dialog id="dlgTabela">
    <div class="sheet">
      <h3>Tabela de preços</h3>
      <ul style="list-style:none;padding:0;margin:6px 0">
        <li>Cabelo — R$ 35,00</li>
        <li>Barba — R$ 30,00</li>
        <li>Perfil — R$ 20,00</li>
        <li>Sobrancelha — R$ 15,00</li>
        <li>Luzes — R$ 80,00</li>
        <li>Relaxamento — R$ 50,00</li>
        <li>Pigmentação — R$ 40,00</li>
        <li>Platinado — R$ 130,00</li>
      </ul>
      <div class="sheet-actions">
        <button class="ghost" id="fecharTabela" type="button">Fechar</button>
      </div>
    </div>
  </dialog>

  <!-- pequeno helper para harmonizar os serviços -->
  <script type="module">
    const observer = new MutationObserver(() => {
      document.querySelectorAll('#services label').forEach(l => {
        l.classList.add('svcItem');
        const spans = l.querySelectorAll('span,strong');
        if (spans[0]) spans[0].classList.add('svcLabel');
        if (spans[1]) spans[1].classList.add('svcPrice');
      });
    });
    observer.observe(document.getElementById('services'), { childList: true, subtree: true });
  </script>

  <script type="module" src="./client.js"></script>
</body>
</html>
